---
title: "child"
author: "sl team"
date: "4/26/2020"
output: html_document
---

```{r, echo = FALSE}
my_subset <- filter(my_vars, family == families[k] & !is.na(variable))

numeric <- filter(my_subset, !is.na(numeric))
categorical <- filter(my_subset, is.na(numeric))
```


## `r gsub("_", " ", families[k])`  {.tabset  .tabset-pills}


***


### Aggregates



#### Aggregates and time trends

```{r, eval=(nrow(numeric)>0), echo = FALSE, fig.cap="3 day moving average with 95% confidence intervals", fig.height = nrow(my_subset)*1.42 + 1, message = FALSE, warning = FALSE}
plot_mov_avg(my_data, numeric, pd = pd, switch = switch)
```

```{r, eval=(nrow(categorical)>0) && nrow(categorical)==2, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
dashdash:::all_bar_plot(my_data, categorical, nrow=1)
```
 
```{r, eval=(nrow(categorical)>0) && nrow(categorical)>=10, message = FALSE, warning = FALSE, results = 'hide'}
dashdash:::all_bar_plot(my_data, categorical, nrow=10)
```

```{r, eval=(nrow(categorical)>0) && nrow(categorical)<10 && nrow(categorical)>4, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
dashdash:::all_bar_plot(my_data, categorical, nrow=4)
```

```{r, eval=(nrow(categorical)>0) && nrow(categorical)==4, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
dashdash:::all_bar_plot(my_data, categorical, nrow=2)
```

```{r, eval=(nrow(categorical)>0) && nrow(categorical)==3, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
dashdash:::all_bar_plot(my_data, categorical, nrow=2)
```


### Current averages

```{r, echo = FALSE, message = FALSE}

current_means <- get_current_means(my_data, my_subset, recent = 1)

kable(current_means, caption = paste("Mean responses in each ", group, " (most recent date)"), 
        col.names = c(group, "Date", my_subset$short_label), 
        digits = 2)

```


<!-- Optionally add maps -->

```{r, child = add_mapsRmd, echo = FALSE, eval = add_maps}

```


### Definitions of measures

```{r, echo = FALSE, warning = FALSE}

if("min" %in% colnames(my_subset) & "max" %in% colnames(my_subset))
{
  my_subset %>% mutate(range = paste(as.character(min), "-", as.character(max))) %>%
    select(short_label, description, range, scale) %>% 
   kable(caption = "Data definitions", col.names = c("Measure", "Definition", "Range", "Response options"))
}else {
  my_subset %>% select(short_label, description) %>% 
  kable(caption = "Data definitions", col.names = c("Measure", "Definition"))
  }

```

```{r, include = FALSE}
k <- k+1
```

```{r, child = childRmd, echo = FALSE, eval = k <= n_families}

```
